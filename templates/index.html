<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini App</title>
<style>
/* —Ç–≤–æ–π CSS –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
</style>
</head>
<body>
  <div id="notInTelegram" class="warn">
    <img alt="TLogo" src="https://telegram.org/img/t_logo.png">
    <p><strong>–£–ø—Å!</strong></p>
    <p>–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω–æ <strong>–≤–Ω—É—Ç—Ä–∏ Telegram!</strong></p>
  </div>

  <div id="mainApp" class="main">
    <h1>–ü—Ä–∏–≤–µ—Ç –∏–∑ Mini App üëã</h1>
    <p>MiniApp —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—Ä—ã—Ç –≤ Telegram!</p>
    <button id="actionBtn" class="btn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    <form id="dataForm">
      <input required id="nameInput" placeholder="–í–∞—à–µ –∏–º—è" type="text">
      <textarea required id="msgInput" placeholder="–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"></textarea>
      <button class="btn" type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </form>
  </div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
  const tg = window.Telegram.WebApp;

  if (!tg) {
    document.getElementById("notInTelegram").style.display = "flex";
    document.getElementById("mainApp").style.display = "none";
  } else {
    document.getElementById("notInTelegram").style.display = "none";
    document.getElementById("mainApp").style.display = "block";
  }

  const form = document.getElementById("dataForm");
  const actionBtn = document.getElementById("actionBtn");

  actionBtn.addEventListener("click", () => {
    form.style.display = "flex";
    actionBtn.style.display = "none";
  });

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const name = document.getElementById("nameInput").value.trim();
    const msg = document.getElementById("msgInput").value.trim();

    if (!name || !msg) return;

    const payload = { name, message: msg };

    tg.sendData(JSON.stringify(payload));
  });
</script>
</body>
</html>
